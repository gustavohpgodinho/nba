require(tidyverse)


#' @title define_ind_variable
#'
#' @description This function creates a variable to identify the type of play to help us put a cod to identify them better.
#' @param df a dataframe with pbp data
#'
#' @return a data frame with the play by play data with a ind column that assign some play's feature
#' @export
#'
#' @examples
define_ind_variable <- function(df){
  
  df %>% 
    dplyr::mutate(ind = 0) %>% 
    dplyr::mutate(description = ifelse(is.na(description), "", description)) %>% 
    dplyr::mutate(ind = ifelse(stringr::str_detect(description, 'BLOCK'), ind + 1, ind),
                  ind = ifelse(stringr::str_detect(description, 'AST'), ind + 1, ind),
                  ind = ifelse(stringr::str_detect(description, "3PT"), ind + 10, ind),
                  ind = ifelse(tp_event == 3 & stringr::str_detect(description, "^MISS"), ind + 5, ind),
                  ind = ifelse(stringr::str_detect(description, 'STEAL'), ind + 1, ind),
                  ind = ifelse(stringr::str_detect(description, '\\(P[0-9]+\\)'), ind + 10, ind),
                  ind = ifelse(stringr::str_detect(description, 'P[0-9]+\\.PN'), ind + 3, ind),
                  ind = ifelse(stringr::str_detect(description, 'P[0-9]+\\.T[0-9]+'), ind + 6, ind),
                  ind = ifelse(stringr::str_detect(description, 'T\\#'), ind + 9, ind),
                  ind = ifelse(clock == "12:00:00" & period == 1 & tp_event == 10, ind + 1, ind),
                  ind = ifelse(clock == "05:00:00" & period >= 5 & tp_event == 10, ind + 2, ind),
                  ind = ifelse(tp_event %in% c(12, 13), period + 10, ind)) %>% 
    dplyr::mutate(ind = ifelse(tp_event %in% c(12, 13) & ind > 14, 15, ind))
}

#' @title pre_process_pbp_data
#'
#' @description create some some columns like type of person envolved in the play, type of play and categorize some time of shots
#' @param df dataframe with the play by play data
#'
#' @return a dataframe with the play by play data and some columns that help us to undestand better the play.
#' @details this function should be used only after the function define_ind_variable, because it uses the ind column to create the new columns
#' @export
#'
#' @examples
pre_process_pbp_data <- function(df){
  
  
  df %>% 
    dplyr::mutate(p = stringr::str_replace_all(persons, '1', 'r'),
                  p = stringr::str_replace_all(p, '2|3', 't'),
                  p = stringr::str_replace_all(p, '4|5', 'p'),
                  p = stringr::str_replace_all(p, '6|7', 'c')) %>% 
    dplyr::mutate(p = ifelse(tp_event %in% c(5, 7, 18), stringr::str_sub(p, 1, 2), p)) %>% 
    dplyr::mutate(tp = ifelse(tp_event > 2, tp_subevent, "")) %>% 
    dplyr::mutate(tp = ifelse(tp_event == 1 & ind == 10 & persons %in% c('400', '500'), "5", tp),
                  tp = ifelse(tp_event == 1 & ind == 11 & persons %in% c('440', '550'), "51", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Dunk"), "1", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Dunk"), "11", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Hook"), "2", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Hook"), "21", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Layup"), "3", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Layup"), "31", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Jump") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Jump") & tp == "", "41", tp), 
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Tip") & tp == "", "3", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Tip") & tp == "", "31", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Bank") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Bank") & tp == "", "41", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & stringr::str_detect(tp_subaction, "Fadeaway") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & stringr::str_detect(tp_subaction, "Fadeaway") & tp == "", "41", tp),
                  tp = ifelse(tp_event == 1 & ind == 0 & tp == "", "4", tp),
                  tp = ifelse(tp_event == 1 & ind == 1 & tp == "", "41", tp),
                  tp = ifelse(tp_event == 2 & ind == 10 & persons %in% c('400', '500'), "5", tp),
                  tp = ifelse(tp_event == 2 & ind == 11 & persons %in% c('405', '504', '501'), "52", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Dunk"), "1", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Dunk"), "12", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Hook"), "2", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Hook"), "22", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Layup"), "3", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Layup"), "32", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Jump") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Jump") & tp == "", "42", tp), 
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Tip") & tp == "", "3", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Tip") & tp == "", "32", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Bank") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Bank") & tp == "", "42", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & stringr::str_detect(tp_subaction, "Fadeaway") & tp == "", "4", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & stringr::str_detect(tp_subaction, "Fadeaway") & tp == "", "42", tp),
                  tp = ifelse(tp_event == 2 & ind == 0 & tp == "", "4", tp),
                  tp = ifelse(tp_event == 2 & ind == 1 & tp == "", "42", tp))
  
}

#' @title define_plays_pcod
#'
#' @description PUT DOCUMENTATION IN THIS FUNCITON
#' @param df 
#'
#' @return
#' @export
#'
#' @examples
define_plays_pcod <- function(df){
  
  df %>% 
    dplyr::mutate(pcod = paste0('p', persons, cod),
                  pcod = ifelse(pcod == "p450_10(0)", "p454_10(0)", pcod),
                  pcod = ifelse(pcod == "p452_10(0)", "p454_10(0)", pcod),
                  pcod = ifelse(pcod == "p453_10(0)", "p455_10(0)", pcod),
                  pcod = ifelse(pcod == "p542_10(0)", "p454_10(0)", pcod),
                  pcod = ifelse(pcod == "p544_10(0)", "p454_10(0)", pcod),
                  pcod = ifelse(pcod == "p543_10(0)", "p455_10(0)", pcod),
                  pcod = ifelse(pcod == "p545_10(0)", "p455_10(0)", pcod),
                  
                  pcod = ifelse(pcod == "p450_10(1)", "p454_10(1)", pcod),
                  pcod = ifelse(pcod == "p452_10(1)", "p454_10(1)", pcod),
                  pcod = ifelse(pcod == "p453_10(1)", "p455_10(1)", pcod),
                  pcod = ifelse(pcod == "p542_10(1)", "p454_10(1)", pcod),
                  pcod = ifelse(pcod == "p544_10(1)", "p454_10(1)", pcod),
                  pcod = ifelse(pcod == "p543_10(1)", "p455_10(1)", pcod),
                  pcod = ifelse(pcod == "p545_10(1)", "p455_10(1)", pcod),
                  
                  pcod = ifelse(pcod == "p450_10(2)", "p454_10(2)", pcod),      
                  pcod = ifelse(pcod == "p452_10(2)", "p454_10(2)", pcod),
                  pcod = ifelse(pcod == "p453_10(2)", "p455_10(2)", pcod),
                  pcod = ifelse(pcod == "p542_10(2)", "p454_10(2)", pcod),
                  pcod = ifelse(pcod == "p544_10(2)", "p454_10(2)", pcod),
                  pcod = ifelse(pcod == "p543_10(2)", "p455_10(2)", pcod),
                  pcod = ifelse(pcod == "p545_10(2)", "p455_10(2)", pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_18'), stringr::str_replace(pcod, "(p[0-9]{3})(_.+?)", "p001\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_1\\(.\\)'), stringr::str_replace(pcod, "(p[24][0-9]{2})(_.+?)", "p400\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_1\\(.a\\)'), stringr::str_replace(pcod, "(p[24][0-9]{2})(_.+?)", "p440\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_1\\(.\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p500\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_1\\(.a\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p550\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_2\\(.\\)'), stringr::str_replace(pcod, "(p[24][0-9]{2})(_.+?)", "p400\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_2\\(.b\\)'), stringr::str_replace(pcod, "(p[24][0-9]{2})(_.+?)", "p405\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_2\\(.\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p500\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_2\\(.b\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p504\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_3\\(.\\)'), stringr::str_replace(pcod, "(p[24][0-9]{2})(_.+?)", "p400\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_3\\(.\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p500\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_4\\(0[up]'), stringr::str_replace(pcod, "(p[024][0-9]{2})(_.+?)", "p400\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_4\\(0[up]'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p500\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_4\\([01]t\\)'), stringr::str_replace(pcod, "(p[024][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_4\\([01]t\\)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p300\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((25|36|37|38|39|40)'), stringr::str_replace(pcod, "(p[024][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((25|36|37|38|39|40)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p300\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((00|12|13|14|15|16|17|18|19|20|21|22|23|24|26|27|28|29|30|31|32|33|34|41|43)'), stringr::str_replace(pcod, "(p[024][0-9]{2})(_.+?)", "p400\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((00|12|13|14|15|16|17|18|19|20|21|22|23|24|26|27|28|29|30|31|32|33|34|41|43)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p500\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((01|11|35)'), stringr::str_replace(pcod, "(p[024][0-9]{2})(_.+?)", "p450\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_5\\((01|11|35)'), stringr::str_replace(pcod, "(p[35][0-9]{2})(_.+?)", "p540\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(01c'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p601\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(01c'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p701\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((01|05)p'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p401\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((01|05)p'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p501\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((01|06|08|09)t'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p201\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((01|06|08|09)t'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p301\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((10|11|12|13|14|15|16|17|19|20|21|22|18)'), stringr::str_replace(pcod, "(p[246][0-9]{2})(_.+?)", "p451\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\((10|11|12|13|14|15|16|17|19|20|21|22)'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p541\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4cc'), stringr::str_replace(pcod, "(p[234567][0-9]{2})(_.+?)", "p671\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4pc'), stringr::str_replace(pcod, "(p4[0-9]{2})(_.+?)", "p471\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4pc'), stringr::str_replace(pcod, "(p5[0-9]{2})(_.+?)", "p561\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4pc'), stringr::str_replace(pcod, "(p6[0-9]{2})(_.+?)", "p651\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4pc'), stringr::str_replace(pcod, "(p7[0-9]{2})(_.+?)", "p741\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_6\\(4pp'), stringr::str_replace(pcod, "(p[0-9]{3})(_.+?)", "p451\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_7\\((0|2|3|4|5|6)'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p401\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_7\\((0|2|3|4|5|6)'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p501\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_7\\(1'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p201\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_7\\(1'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p301\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_8\\(0'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p440\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_8\\(0'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p550\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(0'), stringr::str_replace(pcod, "(p[01][0-9]{2})(_.+?)", "p100\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(0'), stringr::str_replace(pcod, "(p[246][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(0'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p300\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(1'), stringr::str_replace(pcod, "(p[0246][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(1'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p300\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(2'), stringr::str_replace(pcod, "(p[01][0-9]{2})(_.+?)", "p100\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(2'), stringr::str_replace(pcod, "(p[246][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(2'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p300\\2"), pcod),
                  
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(3'), stringr::str_replace(pcod, "(p[01][0-9]{2})(_.+?)", "p100\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(3'), stringr::str_replace(pcod, "(p[246][0-9]{2})(_.+?)", "p200\\2"), pcod),
                  pcod = ifelse(stringr::str_detect(cod, '_9\\(3'), stringr::str_replace(pcod, "(p[357][0-9]{2})(_.+?)", "p300\\2"), pcod))
  
}

#' @title define_plays_cod
#'
#' @description Finally put the cod in play by play data
#' @param df get a dataframe with the plays after pass through the function define_ind_variable and pre_process_pbp_data
#'
#' @return a dataframe with a cod to each play that happened in the games.
#' @details this function should be used only after the function define_ind_variable and pre_process_pbp_data because it uses columns created in these functions.
#' @export
#'
#' @examples
define_plays_cod <- function(df){
  
  # Turnover: Bad Pass (without STEAL) and Out of Bounds - Bad Pass Turnover are grouped at 5(34p)
  # Fouls: Offensive and Offensive Charge are grouped together at 6(13)
  # Tech Fouls: Non-Unsportsmanlike Tech and Hanging Tech are grouped with Tech at 6(01)

  df %>% 
    dplyr::mutate(cod = "") %>% 
    dplyr::mutate(cod = ifelse(tp_event == 1 & tp == '1', "_1(1)", cod),
                  cod = ifelse(tp_event == 1 & tp == '11', "_1(1a)", cod),
                  cod = ifelse(tp_event == 1 & tp == '2', "_1(2)", cod),
                  cod = ifelse(tp_event == 1 & tp == '21', "_1(2a)", cod),
                  cod = ifelse(tp_event == 1 & tp == '3', "_1(3)", cod),
                  cod = ifelse(tp_event == 1 & tp == '31', "_1(3a)", cod),
                  cod = ifelse(tp_event == 1 & tp == '4', "_1(4)", cod),
                  cod = ifelse(tp_event == 1 & tp == '41', "_1(4a)", cod), 
                  cod = ifelse(tp_event == 1 & tp == '5', "_1(5)", cod),
                  cod = ifelse(tp_event == 1 & tp == '51', "_1(5a)", cod), 
                  cod = ifelse(tp_event == 1 & is.na(tp) & ind == 0, '_1(4)', cod),
                  cod = ifelse(tp_event == 1 & is.na(tp) & ind == 1, '_1(4a)', cod),
                  
                  cod = ifelse(tp_event == 2 & tp == '1', "_2(1)", cod),
                  cod = ifelse(tp_event == 2 & tp == '12', "_2(1b)", cod),
                  cod = ifelse(tp_event == 2 & tp == '2', "_2(2)", cod),
                  cod = ifelse(tp_event == 2 & tp == '22', "_2(2b)", cod),
                  cod = ifelse(tp_event == 2 & tp == '3', "_2(3)", cod),
                  cod = ifelse(tp_event == 2 & tp == '32', "_2(3b)", cod),
                  cod = ifelse(tp_event == 2 & tp == '4', "_2(4)", cod),
                  cod = ifelse(tp_event == 2 & tp == '42', "_2(4b)", cod), 
                  cod = ifelse(tp_event == 2 & tp == '5', "_2(5)", cod),
                  cod = ifelse(tp_event == 2 & tp == '52', "_2(5b)", cod), 
                  cod = ifelse(tp_event == 2 & is.na(tp) & ind == 0, '_2(4)', cod),
                  cod = ifelse(tp_event == 2 & is.na(tp) & ind == 1, '_2(4b)', cod),
                  
                  cod = ifelse(tp_event == 3 & tp == '10' & ind == 0, "_3(11c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '10' & ind == 5, "_3(11w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '11' & ind == 0, "_3(12c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '11' & ind == 5, "_3(12w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '12' & ind == 0, "_3(22c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '12' & ind == 5, "_3(22w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '13' & ind == 0, "_3(13c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '13' & ind == 5, "_3(13w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '14' & ind == 0, "_3(23c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '14' & ind == 5, "_3(23w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '15' & ind == 0, "_3(33c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '15' & ind == 5, "_3(33w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '16' & ind == 0, "_3(40c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '16' & ind == 5, "_3(40w)", cod),
                  
                  cod = ifelse(tp_event == 3 & tp == '21' & ind == 0, "_3(40c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '21' & ind == 5, "_3(40w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '22' & ind == 0, "_3(40c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '22' & ind == 5, "_3(40w)", cod),
                  
                  cod = ifelse(tp_event == 3 & tp == '18' & ind == 0, "_3(51c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '18' & ind == 5, "_3(51w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '19' & ind == 0, "_3(52c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '19' & ind == 5, "_3(52w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '20' & ind == 0, "_3(61c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '20' & ind == 5, "_3(61w)", cod),
                  
                  cod = ifelse(tp_event == 3 & tp == '25' & ind == 0, "_3(71c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '25' & ind == 5, "_3(71w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '26' & ind == 0, "_3(72c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '26' & ind == 5, "_3(72w)", cod),
                  cod = ifelse(tp_event == 3 & tp == '27' & ind == 0, "_3(81c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '27' & ind == 5, "_3(81w)", cod), 
                  cod = ifelse(tp_event == 3 & tp == '28' & ind == 0, "_3(82c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '28' & ind == 5, "_3(82w)", cod), 
                  cod = ifelse(tp_event == 3 & tp == '29' & ind == 0, "_3(83c)", cod),
                  cod = ifelse(tp_event == 3 & tp == '29' & ind == 5, "_3(83w)", cod),
                  
                  cod = ifelse(tp_event == 4 & tp == '0' & p == 't00', "_4(0t)", cod),
                  cod = ifelse(tp_event == 4 & tp == '0' & p == 'p00', "_4(0p)", cod),
                  cod = ifelse(tp_event == 4 & tp == '1' & p == 't00', "_4(1t)", cod),
                  
                  cod = ifelse(tp_event == 5 & tp == '42' & p == '00' & ind == 0, "_5(39u)", cod),
                  cod = ifelse(tp_event == 5 & tp == '42' & p == 't0' & ind == 0, "_5(39t)", cod),
                  cod = ifelse(tp_event == 5 & tp == '44' & p == '00' & ind == 0, "_5(40u)", cod),
                  
                  cod = ifelse(tp_event == 5 & tp == '37' & p == 'p0' & ind == 6, "_5(13p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '45' & p == 'p0' & ind == 6, "_5(34p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '4' & p == 'p0' & ind == 6, "_5(12p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '40' & p == 'p0' & ind == 6, "_5(32p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '39' & p == 'p0' & ind == 6, "_5(31p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '8' & p == 'p0' & ind == 6, "_5(16p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '13' & p == 'p0' & ind == 6, "_5(18p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '15' & p == 'p0' & ind == 6, "_5(19p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '1' & p == 'p0' & ind == 6, "_5(34p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '2' & p == 'p0' & ind == 6, "_5(33p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '21' & p == 'p0' & ind == 6, "_5(24p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '6' & p == 'p0' & ind == 6, "_5(14p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '7' & p == 'p0' & ind == 6, "_5(15p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '0' & p == 'p0' & ind == 6, "_5(00p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '12' & p == 'p0' & ind == 6, "_5(17p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '19' & p == 'p0' & ind == 6, "_5(22p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '17' & p == 'p0' & ind == 6, "_5(20p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '20' & p == 'p0' & ind == 6, "_5(23p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '18' & p == 'p0' & ind == 6, "_5(21p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '36' & p == 'p0' & ind == 6, "_5(30p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '35' & p == 'p0' & ind == 6, "_5(29p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '9' & p == 'p0' & ind == 6, "_5(41p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '33' & p == 'p0' & ind == 6, "_5(27p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '34' & p == 'p0' & ind == 6, "_5(28p)", cod),
                  
                  cod = ifelse(tp_event == 5 & tp == '1' & p == 'pp' & ind == 7, "_5(11p)", cod),
                  cod = ifelse(tp_event == 5 & tp == '2' & p == 'pp' & ind == 7, "_5(35p)", cod),
                  
                  cod = ifelse(tp_event == 5 & tp == '11' & p == 't0' & ind == 9, "_5(37t)", cod),
                  cod = ifelse(tp_event == 5 & tp == '9' & p == 't0' & ind == 9, "_5(38t)", cod),
                  cod = ifelse(tp_event == 5 & tp == '10' & p == 't0' & ind == 9, "_5(36t)", cod),
                  cod = ifelse(tp_event == 5 & tp == '24' & p == 'p0' & ind == 6, "_5(36t)", cod),
                  cod = ifelse(tp_event == 5 & tp == '44' & p == 't0' & ind == 9, "_5(40t)", cod),
                  
                  cod = ifelse(tp_event == 6 & tp == '17' & p == 'p0r' & ind == 0, "_6(05p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '11' & p == 'c0r' & ind == 0, "_6(01c)", cod),
                  cod = ifelse(tp_event == 6 & tp == '16' & p == 'ppr' & ind == 0, "_6(4pp)", cod),
                  cod = ifelse(tp_event == 6 & tp == '18' & p == 't0r' & ind == 0, "_6(06t)", cod),
                  cod = ifelse(tp_event == 6 & tp == '10' & p == 'ppr' & ind == 0, "_6(18a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '11' & p == 't0r' & ind == 0, "_6(01t)", cod),
                  cod = ifelse(tp_event == 6 & tp == '18' & p == '00r' & ind == 0, "_6(06u)", cod),
                  cod = ifelse(tp_event == 6 & tp == '25' & p == 't0r' & ind == 0, "_6(08t)", cod),
                  cod = ifelse(tp_event == 6 & tp == '30' & p == 't0r' & ind == 0, "_6(09t)", cod),
                  cod = ifelse(tp_event == 6 & tp == '11' & p == '00r' & ind == 0, "_6(01u)", cod),
                  cod = ifelse(tp_event == 6 & tp == '16' & p == 'cpr' & ind == 0, "_6(4pc)", cod),
                  cod = ifelse(tp_event == 6 & tp == '12' & p == 'c0r' & ind == 0, "_6(01c)", cod),
                  cod = ifelse(tp_event == 6 & tp == '16' & p == 'ccr' & ind == 0, "_6(4cc)", cod),
                  cod = ifelse(tp_event == 6 & tp == '25' & p == '00r' & ind == 0, "_6(08u)", cod),
                  cod = ifelse(tp_event == 6 & tp == '10' & p == 'p0r' & ind == 0, "_6(18a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '16' & p == 'p0r' & ind == 0, "_6(4pp)", cod),
                  cod = ifelse(tp_event == 6 & tp == '16' & p == 'pcr' & ind == 0, "_6(4pc)", cod),
                  cod = ifelse(tp_event == 6 & tp == '18' & p == 'tcr' & ind == 0, "_6(06t)", cod),
                  cod = ifelse(tp_event == 6 & tp == '18' & p == 'tpr' & ind == 0, "_6(06t)", cod),
                  
                  cod = ifelse(tp_event == 6 & tp == '2' & p == 'ppr' & ind == 3, "_6(11p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '1' & p == 'ppr' & ind == 3, "_6(10p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '28' & p == 'ppr' & ind == 3, "_6(21p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '3' & p == 'ppr' & ind == 3, "_6(12p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '26' & p == 'ppr' & ind == 3, "_6(13a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '11' & p == 'p0r' & ind == 3, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '14' & p == 'ppr' & ind == 3, "_6(19p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '6' & p == 'ppr' & ind == 3, "_6(15p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '9' & p == 'ppr' & ind == 3, "_6(17p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '31' & p == 'ppr' & ind == 3, "_6(22p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '15' & p == 'ppr' & ind == 3, "_6(20p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '12' & p == 'ppr' & ind == 3, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '12' & p == 'p0r' & ind == 3, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '13' & p == 'ppr' & ind == 3, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '13' & p == 'p0r' & ind == 3, "_6(01p)", cod),
                  
                  cod = ifelse(tp_event == 6 & tp == '2' & p == 'ppr' & ind == 6, "_6(11a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '1' & p == 'ppr' & ind == 6, "_6(10a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '3' & p == 'ppr' & ind == 6, "_6(12a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '28' & p == 'ppr' & ind == 6, "_6(21a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '11' & p == 'p0r' & ind == 6, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '26' & p == 'ppr' & ind == 6, "_6(13a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '14' & p == 'ppr' & ind == 6, "_6(19a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '6' & p == 'ppr' & ind == 6, "_6(15a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '9' & p == 'ppr' & ind == 6, "_6(17a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '31' & p == 'ppr' & ind == 6, "_6(22a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '15' & p == 'ppr' & ind == 6, "_6(20a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '13' & p == 'p0r' & ind == 6, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '12' & p == 'p0r' & ind == 6, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '1' & p == 'p0r' & ind == 6, "_6(10a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '13' & p == 'ppr' & ind == 6, "_6(01p)", cod),
                  cod = ifelse(tp_event == 6 & tp == '14' & p == 'p0r' & ind == 6, "_6(19a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '8' & p == 'ppr' & ind == 6, "_6(16a)", cod),
                  
                  cod = ifelse(tp_event == 6 & tp == '4' & p == 'ppr' & ind == 10, "_6(13a)", cod),
                  cod = ifelse(tp_event == 6 & tp == '26' & p == 'ppr' & ind == 10, "_6(13a)", cod),
                  
                  cod = ifelse(tp_event == 7 & tp == '1' & p == '00', "_7(1u)", cod),
                  cod = ifelse(tp_event == 7 & tp == '1' & p == 't0', "_7(1t)", cod),
                  cod = ifelse(tp_event == 7 & tp == '2' & p == 'p0', "_7(2p)", cod),
                  cod = ifelse(tp_event == 7 & tp == '3' & p == 'p0', "_7(3p)", cod),
                  cod = ifelse(tp_event == 7 & tp == '4' & p == 'p0', "_7(4p)", cod),
                  cod = ifelse(tp_event == 7 & tp == '5' & p == 'p0', "_7(5p)", cod),
                  cod = ifelse(tp_event == 7 & tp == '6' & p == 'p0', "_7(6p)", cod),
                  
                  cod = ifelse(tp_event == 8, "_8(0)", cod),
                  
                  cod = ifelse(tp_event == 9 & tp == '1', "_9(0)", cod),
                  cod = ifelse(tp_event == 9 & tp == '7', "_9(1)", cod),
                  
                  cod = ifelse(tp_event == 10 & tp == '0' & ind %in% c(1, 2), "_10(0)", cod),
                  cod = ifelse(tp_event == 10 & tp == '0' & ind == 0, "_10(1)", cod),
                  cod = ifelse(tp_event == 10 & tp == '1', "_10(2)", cod),
                  cod = ifelse(tp_event == 10 & tp == '0' & is.na(ind), "_10(0)", cod),
                  
                  cod = ifelse(tp_event == 11 & p == 'c0r', "_11(1)", cod),
                  cod = ifelse(tp_event == 11 & p == 'p0r', "_11(0)", cod),
                  
                  cod = ifelse(tp_event == 12 & ind == 11, "_12(1)", cod),
                  cod = ifelse(tp_event == 12 & ind == 12, "_12(2)", cod),
                  cod = ifelse(tp_event == 12 & ind == 13, "_12(3)", cod),
                  cod = ifelse(tp_event == 12 & ind == 14, "_12(4)", cod),
                  cod = ifelse(tp_event == 12 & ind == 15, "_12(0)", cod),
                  
                  cod = ifelse(tp_event == 13 & ind == 11, "_13(1)", cod),
                  cod = ifelse(tp_event == 13 & ind == 12, "_13(2)", cod),
                  cod = ifelse(tp_event == 13 & ind == 13, "_13(3)", cod),
                  cod = ifelse(tp_event == 13 & ind == 14, "_13(4)", cod),
                  cod = ifelse(tp_event == 13 & ind == 15, "_13(0)", cod),
                  
                  cod = ifelse(tp_event == 18 & tp == '0', "_18(0)", cod),
                  cod = ifelse(tp_event == 18 & tp == '1', "_18(1)", cod),
                  cod = ifelse(tp_event == 18 & tp == '2', "_18(2)", cod),
                  cod = ifelse(tp_event == 18 & tp == '3', "_18(3)", cod),
                  cod = ifelse(tp_event == 18 & tp == '4', "_18(4)", cod),
                  cod = ifelse(tp_event == 18 & tp == '5', "_18(5)", cod),
                  cod = ifelse(tp_event == 18 & tp == '6', "_18(6)", cod),
                  cod = ifelse(tp_event == 18 & tp == '7', "_18(7)", cod)) %>% 
    
    dplyr::mutate(cod = ifelse(tp_event == 3 & tp == '24' & ind == 0, '_3(00c)', cod),
                  cod = ifelse(tp_event == 3 & tp == '23' & ind == 5, '_3(00w)', cod),
                  cod = ifelse(tp_event == 4 & p == '000' & cod == "", '_4(0u)', cod),
                  cod = ifelse(tp_event == 4 & p == 'p00' & cod == "", '_4(0p)', cod),
                  cod = ifelse(tp_event == 4 & p == 't00' & cod == "", '_4(1t)', cod),
                  
                  cod = ifelse(tp_event == 5 & tp == '0' & cod == "", '_5(01p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '1' & cod == "", '_5(34p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '2' & cod == "", '_5(33p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '3' & cod == "", '_5(31p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '4' & cod == "", '_5(12p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '5' & cod == "", '_5(13p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '8' & cod == "", '_5(16p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '11' & cod == "", '_5(37t)', cod),
                  cod = ifelse(tp_event == 5 & tp == '12' & cod == "", '_5(25t)', cod),
                  cod = ifelse(tp_event == 5 & tp == '13' & cod == "", '_5(18p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '15' & cod == "", '_5(19p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '17' & cod == "", '_5(20p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '18' & cod == "", '_5(21p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '19' & cod == "", '_5(22p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '20' & cod == "", '_5(23p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '23' & cod == "", '_5(26p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '32' & cod == "", '_5(43p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '37' & cod == "", '_5(13p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '38' & cod == "", '_5(38t)', cod),
                  cod = ifelse(tp_event == 5 & tp == '40' & cod == "", '_5(35p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '41' & ind == 6 & cod == "", '_5(33p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '41' & ind == 9 & cod == "", '_5(33p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '41' & ind == 7 & cod == "", '_5(35p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '42' & cod == "", '_5(39t)', cod),
                  cod = ifelse(tp_event == 5 & tp == '43' & cod == "", '_5(31p)', cod),
                  cod = ifelse(tp_event == 5 & tp == '52' & cod == "", '_5(01p)', cod),
                  
                  cod = ifelse(tp_event == 6 & tp == '16' & cod == "", '_6(4cc)', cod),
                  cod = ifelse(tp_event == 6 & tp == '1' & ind == 0 & cod == "", '_6(10a)', cod),
                  cod = ifelse(tp_event == 6 & tp == '2' & ind == 0 & cod == "", '_6(11a)', cod),
                  cod = ifelse(tp_event == 6 & tp == '2' & ind == 3 & cod == "", '_6(11p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '5' & ind == 3 & cod == "", '_6(14p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '5' & ind == 6 & cod == "", '_6(14a)', cod),
                  cod = ifelse(tp_event == 6 & tp == '19' & ind == 3 & cod == "", '_6(01p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '19' & ind == 6 & cod == "", '_6(01p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '19' & cod == "", '_6(01p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '27' & ind == 3 & cod == "", '_6(10p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '27' & ind == 6 & cod == "", '_6(10a)', cod),
                  cod = ifelse(tp_event == 6 & tp == '29' & ind == 3 & cod == "", '_6(11p)', cod),
                  cod = ifelse(tp_event == 6 & tp == '29' & ind == 6 & cod == "", '_6(11a)', cod),
                  cod = ifelse(tp_event == 6 & tp == '32' & cod == "", '_6(01p)', cod),
                  
                  cod = ifelse(tp_event == 7 & tp == '0' & cod == "", '_7(0p)', cod),
                  cod = ifelse(tp_event == 7 & tp == '6' & cod == "", '_7(6p)', cod),
                  cod = ifelse(tp_event == 7 & tp == '18' & cod == "", '_7(0p)', cod),
                  
                  cod = ifelse(tp_event == 9 & tp == '2' & cod == "", '_9(0)', cod),
                  cod = ifelse(tp_event == 9 & tp == '4' & cod == "", '_9(2)', cod),
                  cod = ifelse(tp_event == 9 & tp == '0' & cod == "", '_9(3)', cod)) %>% 
    define_plays_pcod()
}

#' @title execute_pre_process_data
#'
#' @description Just put all the previously functions together to put codes in plays.
#' @param df a dataframe with the plays of nba games
#'
#' @return a dataframe with the play by play data categorized by codes
#' @export
#'
#' @examples
execute_pre_process_data <- function(df){
  
  df %>% 
    define_ind_variable() %>% 
    dplyr::mutate(tp_subaction = stringr::str_trim(string = tp_subaction),
                  tp_subaction = ifelse(tp_subaction == "", NA_character_, tp_subaction)) %>% 
    pre_process_pbp_data() %>% 
    define_plays_cod()
  
  
}

#' @title fix_plays_without_team
#'
#' @description just a huge function to put the right team in plays that don't have it.
#' @param df a dataframe with the plays of nba games with the cod column
#'
#' @return a dataframe with the play by play data with the plays without team fixed.
#' @export
#'
#' @examples
fix_plays_without_team <- function(df){
  
  df %>% 
    dplyr::mutate(location = ifelse(game_id == '0021900620' & action_id ==  81 & cod == '_6(01u)', 'h', location),
                  location = ifelse(game_id == '0021900691' & action_id ==  76 & cod == '_6(01u)', 'v', location),
                  location = ifelse(game_id == '0021900703' & action_id == 290 & cod == '_6(01u)', 'h', location),
                  cod = ifelse(cod == '_6(01u)', '_6(01t)', cod)) %>% 
    dplyr::mutate(location = ifelse(game_id == "0021900291" & action_id ==  65 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900291" & action_id == 375 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900324" & action_id == 192 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900326" & action_id == 489 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900341" & action_id == 247 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900342" & action_id == 316 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900361" & action_id == 249 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900361" & action_id == 296 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900379" & action_id == 282 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900387" & action_id == 273 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900395" & action_id == 363 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900404" & action_id == 541 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900460" & action_id == 477 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900487" & action_id == 255 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900524" & action_id == 399 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900535" & action_id == 159 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900682" & action_id == 113 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900757" & action_id == 245 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021900844" & action_id == 318 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021900883" & action_id == 405 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0021901237" & action_id == 295 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0021901313" & action_id == 123 & cod == '_6(06u)', 'v', location),
                  location = ifelse(game_id == "0041900177" & action_id == 207 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0022000042" & action_id == 331 & cod == '_6(06u)', 'h', location),
                  location = ifelse(game_id == "0022000317" & action_id == 258 & cod == '_6(06u)', 'v', location),
                  cod = ifelse(cod == '_6(06u)', '_6(06t)', cod)) %>% 
    dplyr::mutate(location = ifelse(game_id == '0041800406' & action_id == 482 & cod == '_6(08u)', 'h', location),
                  location = ifelse(game_id == '0022000285' & action_id == 462 & cod == '_6(08u)', 'v', location),
                  cod = ifelse(cod == '_6(08u)', '_6(08t)', cod)) %>% 
    dplyr::mutate(location = ifelse(game_id == "0021800001" & action_id == 344 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800002" & action_id == 502 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800003" & action_id == 255 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800008" & action_id == 522 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800014" & action_id == 314 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800020" & action_id == 116 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800019" & action_id ==  23 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800031" & action_id == 384 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800035" & action_id == 364 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800037" & action_id == 427 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800038" & action_id == 147 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800045" & action_id == 248 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800048" & action_id == 387 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800058" & action_id == 173 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800058" & action_id == 438 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800060" & action_id == 206 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800065" & action_id == 247 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800069" & action_id == 161 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800073" & action_id == 233 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800073" & action_id == 360 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800075" & action_id ==  66 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800076" & action_id == 217 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800077" & action_id == 191 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800079" & action_id == 118 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800082" & action_id == 259 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800085" & action_id == 292 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800087" & action_id == 457 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800088" & action_id == 460 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800092" & action_id == 248 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800092" & action_id == 342 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800101" & action_id == 283 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800103" & action_id ==  43 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800108" & action_id == 201 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800108" & action_id == 316 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800109" & action_id ==  88 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800112" & action_id == 366 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800114" & action_id == 213 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800119" & action_id == 171 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800123" & action_id == 274 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800128" & action_id ==   2 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800129" & action_id == 178 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800132" & action_id == 404 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800134" & action_id == 306 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800136" & action_id == 427 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800140" & action_id == 345 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800144" & action_id == 345 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800145" & action_id ==  73 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800146" & action_id == 257 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800146" & action_id == 319 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800148" & action_id == 151 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800151" & action_id ==  41 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800152" & action_id == 188 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800154" & action_id ==  36 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800155" & action_id ==  94 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800157" & action_id == 399 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800158" & action_id == 255 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800160" & action_id == 417 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800161" & action_id == 388 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800163" & action_id == 243 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800163" & action_id == 372 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800164" & action_id == 246 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800168" & action_id ==  90 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800168" & action_id == 137 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800170" & action_id == 123 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800173" & action_id == 348 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800176" & action_id == 126 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800176" & action_id == 301 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800178" & action_id == 237 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800179" & action_id == 298 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800181" & action_id == 365 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800181" & action_id == 380 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800185" & action_id == 340 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800188" & action_id == 361 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800192" & action_id ==  51 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800194" & action_id == 416 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800196" & action_id == 390 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800197" & action_id == 363 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800198" & action_id == 516 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800200" & action_id == 216 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800209" & action_id == 114 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800210" & action_id == 195 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800212" & action_id ==   6 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800213" & action_id == 338 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800215" & action_id == 222 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800216" & action_id == 202 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800219" & action_id ==  56 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800223" & action_id ==  76 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800232" & action_id ==  92 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800235" & action_id == 491 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800236" & action_id ==  87 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800237" & action_id == 195 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800238" & action_id == 119 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800239" & action_id ==  99 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800243" & action_id == 107 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800246" & action_id == 371 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800247" & action_id == 507 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800254" & action_id == 222 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800254" & action_id == 239 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800255" & action_id == 300 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800258" & action_id ==  35 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800259" & action_id == 316 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800261" & action_id == 220 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800263" & action_id == 499 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800268" & action_id == 297 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800271" & action_id == 329 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800273" & action_id == 314 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800275" & action_id == 231 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800277" & action_id == 313 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800278" & action_id == 156 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800279" & action_id ==  90 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800282" & action_id == 180 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800283" & action_id == 342 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800293" & action_id == 355 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800301" & action_id == 160 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800302" & action_id == 129 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800305" & action_id ==  59 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800306" & action_id == 535 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800313" & action_id ==  53 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800313" & action_id == 213 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800315" & action_id == 113 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800317" & action_id == 317 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800321" & action_id == 225 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800322" & action_id ==  12 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800323" & action_id ==  30 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800325" & action_id == 220 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800328" & action_id == 504 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800329" & action_id == 383 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800331" & action_id == 175 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800336" & action_id ==  97 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800337" & action_id == 403 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800338" & action_id == 355 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800340" & action_id == 153 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800341" & action_id ==  80 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800343" & action_id == 267 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800344" & action_id == 333 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800346" & action_id == 157 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800347" & action_id ==  72 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800349" & action_id == 307 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800357" & action_id == 246 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800363" & action_id == 366 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800370" & action_id == 242 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800371" & action_id == 365 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800372" & action_id == 236 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800379" & action_id == 321 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800381" & action_id ==  22 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800383" & action_id == 418 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800386" & action_id == 471 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800387" & action_id == 244 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800396" & action_id == 192 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800396" & action_id == 420 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800398" & action_id == 363 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800400" & action_id == 282 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800402" & action_id == 280 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800404" & action_id == 270 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800408" & action_id == 357 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800412" & action_id == 163 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800420" & action_id ==  63 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800420" & action_id == 538 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800423" & action_id == 379 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800426" & action_id ==  25 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800428" & action_id == 248 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800429" & action_id == 259 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800446" & action_id == 245 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800447" & action_id == 451 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800450" & action_id == 186 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800450" & action_id == 292 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800452" & action_id == 148 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800462" & action_id == 207 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800463" & action_id == 363 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800477" & action_id ==  47 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800488" & action_id == 150 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800496" & action_id == 267 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800497" & action_id ==  86 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800497" & action_id == 347 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800500" & action_id == 417 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800502" & action_id == 433 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800508" & action_id ==  61 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800509" & action_id == 289 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800513" & action_id == 229 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800513" & action_id == 313 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800515" & action_id ==  10 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800521" & action_id == 396 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800522" & action_id == 451 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800524" & action_id == 307 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800527" & action_id == 168 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800538" & action_id == 225 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800541" & action_id == 356 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800551" & action_id ==  44 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800554" & action_id == 328 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800557" & action_id == 235 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800558" & action_id ==  63 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800558" & action_id == 159 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800559" & action_id ==  82 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800559" & action_id == 189 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800560" & action_id == 108 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800561" & action_id == 278 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800568" & action_id == 219 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800571" & action_id == 472 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800573" & action_id == 295 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800576" & action_id == 153 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800582" & action_id == 415 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800583" & action_id ==  78 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800583" & action_id == 130 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800586" & action_id == 482 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800588" & action_id == 223 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800591" & action_id ==  89 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800594" & action_id ==  45 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800599" & action_id == 190 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800603" & action_id == 280 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800605" & action_id == 136 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800606" & action_id == 435 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800608" & action_id ==  43 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800609" & action_id == 560 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800611" & action_id == 213 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800613" & action_id == 220 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800618" & action_id == 375 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800620" & action_id == 221 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800622" & action_id == 416 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800626" & action_id ==  52 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800629" & action_id == 273 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800629" & action_id == 411 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800630" & action_id ==  65 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800630" & action_id == 309 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800631" & action_id == 108 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800632" & action_id ==  26 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800633" & action_id == 267 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800638" & action_id == 267 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800649" & action_id == 437 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800653" & action_id == 479 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800656" & action_id == 131 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800659" & action_id == 453 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800660" & action_id == 230 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800661" & action_id == 192 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800674" & action_id == 264 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800678" & action_id == 496 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800680" & action_id == 229 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800680" & action_id == 315 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800690" & action_id == 260 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800692" & action_id == 437 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800693" & action_id ==  69 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800693" & action_id ==  90 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800696" & action_id ==  81 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800697" & action_id == 212 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800698" & action_id == 120 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800702" & action_id == 221 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800707" & action_id == 133 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800707" & action_id == 192 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800708" & action_id == 476 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800714" & action_id == 214 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800715" & action_id == 304 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800727" & action_id == 379 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800728" & action_id ==  64 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800730" & action_id == 387 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800731" & action_id == 165 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800733" & action_id == 337 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800733" & action_id == 499 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800734" & action_id == 496 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800738" & action_id == 283 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800739" & action_id == 350 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800741" & action_id == 201 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800743" & action_id == 127 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800747" & action_id == 393 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800750" & action_id == 399 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800751" & action_id == 255 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800763" & action_id ==  95 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800769" & action_id == 390 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800773" & action_id == 216 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800773" & action_id == 288 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800775" & action_id == 379 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800775" & action_id == 403 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800780" & action_id == 410 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800781" & action_id == 335 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800782" & action_id == 124 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800782" & action_id == 266 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800783" & action_id == 302 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800784" & action_id ==  73 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800785" & action_id == 234 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800785" & action_id == 260 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800795" & action_id == 419 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800806" & action_id ==  78 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800806" & action_id == 220 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800809" & action_id == 312 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800812" & action_id == 353 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800814" & action_id ==  46 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800815" & action_id == 332 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800818" & action_id == 166 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800819" & action_id == 217 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800819" & action_id == 381 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800820" & action_id == 108 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800826" & action_id == 139 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800830" & action_id == 332 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800832" & action_id == 492 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800836" & action_id ==  92 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800838" & action_id == 331 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800840" & action_id ==  55 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800841" & action_id == 113 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800841" & action_id == 407 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800843" & action_id == 298 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800845" & action_id == 232 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800848" & action_id == 182 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800854" & action_id == 480 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800866" & action_id == 223 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800868" & action_id == 308 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800868" & action_id == 320 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800869" & action_id == 145 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800878" & action_id == 332 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800881" & action_id == 293 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800883" & action_id == 357 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800885" & action_id == 374 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800886" & action_id == 361 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800892" & action_id == 310 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800894" & action_id == 210 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800896" & action_id == 191 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800900" & action_id == 452 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800904" & action_id == 513 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800905" & action_id == 281 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800912" & action_id == 331 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800915" & action_id == 368 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800921" & action_id == 240 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800924" & action_id == 248 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800925" & action_id == 386 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800927" & action_id ==  54 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800928" & action_id == 500 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800935" & action_id == 175 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800937" & action_id == 435 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800939" & action_id == 123 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800938" & action_id == 226 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800943" & action_id == 479 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800948" & action_id == 171 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800963" & action_id == 132 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800967" & action_id == 414 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800970" & action_id == 296 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800970" & action_id == 432 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800973" & action_id == 194 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800976" & action_id == 516 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800977" & action_id == 199 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800979" & action_id == 214 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800983" & action_id ==  14 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800984" & action_id == 118 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021800987" & action_id == 279 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800994" & action_id == 178 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021800999" & action_id == 324 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801000" & action_id == 365 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801001" & action_id == 223 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801001" & action_id == 402 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801002" & action_id == 464 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801004" & action_id == 299 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801009" & action_id == 107 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801009" & action_id == 321 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801012" & action_id == 202 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801013" & action_id == 334 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801015" & action_id == 393 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801014" & action_id == 278 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801021" & action_id == 372 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801033" & action_id == 192 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801035" & action_id ==  44 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801037" & action_id ==  45 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801037" & action_id == 404 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801045" & action_id == 237 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801044" & action_id == 420 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801046" & action_id == 173 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801061" & action_id == 156 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801063" & action_id == 344 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801066" & action_id ==  75 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801067" & action_id == 268 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801072" & action_id == 429 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801073" & action_id ==  67 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801074" & action_id == 214 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801079" & action_id ==  96 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801079" & action_id == 337 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801090" & action_id == 341 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801093" & action_id == 339 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801111" & action_id == 161 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801113" & action_id == 278 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801119" & action_id == 256 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801120" & action_id == 243 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801121" & action_id ==  51 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801123" & action_id ==  11 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801129" & action_id == 220 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801130" & action_id == 275 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801133" & action_id ==  70 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801138" & action_id == 233 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801140" & action_id == 244 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801147" & action_id ==  46 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801151" & action_id == 349 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801159" & action_id == 150 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801166" & action_id == 277 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801168" & action_id == 165 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801173" & action_id == 299 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801174" & action_id == 274 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801180" & action_id == 247 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801184" & action_id == 136 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801185" & action_id == 135 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801191" & action_id ==   2 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801193" & action_id == 330 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801193" & action_id == 379 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801195" & action_id == 412 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801198" & action_id == 194 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801207" & action_id ==  10 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801217" & action_id ==   2 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801220" & action_id == 483 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801221" & action_id == 122 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801222" & action_id == 354 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801227" & action_id == 287 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021801227" & action_id == 329 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021801230" & action_id == 322 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800142" & action_id == 271 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800142" & action_id == 283 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800152" & action_id ==  31 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800102" & action_id == 221 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800133" & action_id == 374 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800103" & action_id == 112 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800174" & action_id == 426 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800115" & action_id ==  35 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800165" & action_id == 269 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800213" & action_id ==  79 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800223" & action_id ==  75 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800225" & action_id == 367 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800226" & action_id ==  25 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800301" & action_id ==  23 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800303" & action_id == 288 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800305" & action_id == 206 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800306" & action_id == 271 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800402" & action_id == 244 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800404" & action_id == 404 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0041800404" & action_id == 422 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0041800405" & action_id ==  67 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900001" & action_id == 297 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900002" & action_id ==  71 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900008" & action_id == 344 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900014" & action_id == 194 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900017" & action_id == 237 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900021" & action_id == 209 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900025" & action_id ==  37 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900026" & action_id ==  99 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900027" & action_id == 111 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900031" & action_id ==   2 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900031" & action_id == 465 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900037" & action_id == 208 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900040" & action_id ==  97 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900045" & action_id == 190 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900045" & action_id == 291 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900048" & action_id == 100 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900055" & action_id == 251 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900056" & action_id == 310 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900060" & action_id == 416 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900062" & action_id == 253 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900065" & action_id == 160 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900065" & action_id == 260 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900070" & action_id == 144 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900078" & action_id == 240 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900081" & action_id ==  72 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900081" & action_id == 276 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900082" & action_id ==  63 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900082" & action_id == 134 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900087" & action_id == 295 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900091" & action_id == 427 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900100" & action_id == 233 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900105" & action_id == 127 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900105" & action_id == 532 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900107" & action_id == 192 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900109" & action_id == 142 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900121" & action_id == 294 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900128" & action_id == 130 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900128" & action_id == 194 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900134" & action_id == 334 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900136" & action_id == 279 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900136" & action_id == 509 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900140" & action_id == 177 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900148" & action_id == 283 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900149" & action_id == 161 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900152" & action_id == 492 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900154" & action_id == 389 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900157" & action_id == 180 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900159" & action_id == 259 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900159" & action_id == 392 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900160" & action_id == 458 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900164" & action_id == 259 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900164" & action_id == 415 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900168" & action_id == 369 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900172" & action_id == 351 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900177" & action_id == 317 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900178" & action_id == 339 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900188" & action_id == 313 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900193" & action_id == 381 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900200" & action_id == 269 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900205" & action_id == 268 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900213" & action_id == 303 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900216" & action_id == 277 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900217" & action_id == 234 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900219" & action_id == 454 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900221" & action_id == 186 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900227" & action_id == 188 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900230" & action_id == 147 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900256" & action_id == 194 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900260" & action_id == 239 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900262" & action_id ==  76 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900264" & action_id == 320 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900269" & action_id ==  80 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900271" & action_id == 123 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900271" & action_id == 372 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900273" & action_id == 252 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900273" & action_id == 355 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900276" & action_id == 171 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900283" & action_id == 334 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900285" & action_id ==  18 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900289" & action_id ==  92 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900291" & action_id ==  27 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900291" & action_id == 244 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900296" & action_id == 419 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900301" & action_id == 257 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900305" & action_id ==  21 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900306" & action_id ==  63 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900307" & action_id == 241 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900309" & action_id == 317 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900313" & action_id == 105 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900313" & action_id == 420 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900317" & action_id ==  67 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900318" & action_id ==  67 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900319" & action_id ==  29 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900323" & action_id == 271 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900324" & action_id ==  70 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900330" & action_id ==  99 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900332" & action_id ==  11 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900333" & action_id == 555 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900339" & action_id == 467 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900340" & action_id == 153 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900341" & action_id == 135 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900342" & action_id ==  67 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900344" & action_id == 261 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900344" & action_id == 344 & cod == '_7(1u)', "v", location),
                  location = ifelse(game_id == "0021900345" & action_id == 431 & cod == '_7(1u)', "h", location),
                  location = ifelse(game_id == "0021900351" & action_id == 307 & cod == '_7(1u)', "v", location),
                  cod = ifelse(cod == '_7(1u)', '_7(1t)', cod)) %>% 
    dplyr::mutate(location = ifelse(game_id == "0042100171" & action_id == 364, "v", location),
                  cod = ifelse(cod == '_5(40u)', '_5(40t)', cod)) %>% 
    dplyr::mutate(location = ifelse(game_id == "0022000285" & action_id == 463, "v", location),
                  location = ifelse(game_id == "0022000215" & action_id == 512, "v", location),
                  location = ifelse(game_id == "0022101135" & action_id == 465, "v", location),
                  location = ifelse(game_id == "0022200323" & action_id == 538, "v", location),
                  cod = ifelse(cod == '_5(39u)', '_5(39t)', cod))
  
}

#' @title build_df_pbp_plays
#' @description put all the previous functions toghether to build the pbp plays dataframe that we'll use for the analysis
#' @param df a dataframe with the pbp data
#'
#' @return a dataframe with the pre-processed pbp data
#' @export
#'
#' @examples
build_df_pbp_plays <- function(df){

  df %>% 
    dplyr::distinct() %>% 
    define_ind_variable() %>% 
    dplyr::mutate(tp_action = stringr::str_trim(tp_action),
                  tp_subaction = stringr::str_trim(tp_subaction)) %>% 
    dplyr::select(season, game_id, num_event, action_id, period, 
                  clock, tp_event, tp_action, tp_subevent, 
                  tp_subaction, persons, location, ind, 
                  xlegacy, ylegacy, shot_distance, description) %>% 
    dplyr::mutate(action_id = as.integer(action_id)) %>% 
    dplyr::arrange(season, game_id, period, desc(clock), action_id) %>% 
    pre_process_pbp_data() %>% 
    dplyr::mutate(p = ifelse(tp_event %in% c(5, 7, 18), stringr::str_sub(p, 1, 2), p)) %>% 
    dplyr::mutate(ind = ifelse(tp_event %in% c(12, 13) & ind > 14, 15, ind)) %>% 
    define_plays_cod() %>% 
    fix_plays_without_team()
  
  
}

#' @title build_df_freq_plays
#' 
#' @description use the previously functions to pre process pbp data to build a dataframe with the frequency of each play
#' @param df a dataframe with the pbp data
#'
#' @return a dataframe with the frequency of each type of play
#' @export
#'
#' @examples
build_df_freq_plays <- function(df){
  
  df %>% 
    define_ind_variable() %>% 
    pre_process_pbp_data() %>% 
    dplyr::mutate(p = ifelse(tp_event %in% c(5, 7, 18), stringr::str_sub(p, 1, 2), p)) %>% 
    dplyr::mutate(ind = ifelse(tp_event %in% c(12, 13) & ind > 14, 15, ind)) %>% 
    define_plays_cod() %>% 
    dplyr::group_by(season, game_id, tp_event, tp_action, 
                    tp_subevent, tp_subaction, period, cod) %>% 
    dplyr::summarise(n = dplyr::n(), .groups = 'drop')
  
}

#' @title put_grammar_in_pbp
#' 
#' @description a huge function to put the proper grammar to each play in nba data using the codes that we put earlier.
#' @param df a daframe with the pbp data categorized by cods 
#'
#' @return a dataframe with the pbp data with the proper grammar in gram column
#' @export
#'
#' @examples
put_grammar_in_pbp <- function(df){
  
  df %>% 
    dplyr::mutate(ind_dist = as.integer(stringr::str_detect(description, "[0-9]+\\'")),
                  ind_no = as.integer(stringr::str_detect(description, "No ")),
                  ind_unk = as.integer(stringr::str_detect(description, "Unknown")),
                  ind_off = as.integer(stringr::str_detect(description, "Offensive")),
                  ind_viot = as.integer(stringr::str_detect(description, "Violation Turnover")),
                  ind_ba = as.integer(stringr::str_detect(description, "Backcourt Turnover")),
                  ind_step = as.integer(stringr::str_detect(description, "Step Out")),
                  ind_play = as.integer(stringr::str_detect(description, "Player Out")),
                  ind_out = as.integer(stringr::str_detect(description, "Out [Oo]f")),
                  ind_pos = as.integer(stringr::str_detect(description, "Poss ")),
                  ind_ste = as.integer(stringr::str_detect(description, "STEAL ")),
                  ind_sec = as.integer(stringr::str_detect(description, "Second Violation")),
                  ind_exc = as.integer(stringr::str_detect(description, "^Excess")),
                  ind_trace = as.integer(stringr::str_detect(description, "\\s+\\-\\s+")),
                  ind_turn = stringr::str_c(ind_no, ind_off, ind_viot, ind_ba, ind_step, 
                                            ind_play, ind_out, ind_pos, ind_ste, ind_sec, 
                                            ind_exc, ind_trace),
                  ind_tfoul = as.integer(stringr::str_detect(description, "Foul\\:T\\.FOUL")),
                  ind_tfoul2 = as.integer(stringr::str_detect(description, "T\\.FOUL")),
                  ind_uns = as.integer(stringr::str_detect(description, "Unsportsmanlike")),
                  ind_pn = as.integer(stringr::str_detect(description, "\\.PN")),
                  cnt_par = stringr::str_count(description, "\\("),
                  ind_hang = as.integer(stringr::str_detect(description, "HANGING")),
                  ind_tau = as.integer(stringr::str_detect(description, "Taunting")),
                  ind_delay = as.integer(stringr::str_detect(description, "Delay")),
                  ind_block = as.integer(stringr::str_detect(description, "Block")),
                  ind_dot = as.integer(stringr::str_detect(description, "\\(\\.\\)")),
                  ind_charge = as.integer(stringr::str_detect(description, "Charge")),
                  ind_tcnt = as.integer(stringr::str_detect(description, "\\.T")),
                  ind_double = as.integer(stringr::str_detect(description, "DOUBLE")),
                  ind_trace = as.integer(stringr::str_detect(description, "\\s+\\-\\s+")),
                  ind_fouls = stringr::str_c(ind_tfoul, ind_tfoul2, ind_uns, ind_pn, cnt_par,
                                             ind_hang, ind_tau, ind_delay, ind_block, ind_dot, 
                                             ind_charge, ind_tcnt, ind_double, ind_trace),
                  ind_vio = as.integer(stringr::str_detect(description, "Violation\\:")),
                  ind_violation = stringr::str_c(ind_no, ind_vio, cnt_par, ind_dot),
                  ind_full = as.integer(stringr::str_detect(description, "Full ")),
                  ind_reg = as.integer(stringr::str_detect(description, "Reg\\.")),
                  ind_reg2 = as.integer(stringr::str_detect(description, "Regular")),
                  ind_short = as.integer(stringr::str_detect(description, "Short")),
                  ind_short2 = as.integer(stringr::str_detect(description, "Short$")),
                  ind_time = as.integer(stringr::str_detect(description, "Timeout\\:\\s+")),
                  ind_timeout = stringr::str_c(ind_full, ind_reg, ind_reg2, ind_short, 
                                               ind_short2, ind_time, ind_no),
                  ind_tipto_ = as.integer(stringr::str_detect(description, "Tip to .+?")),
                  ind_CC = as.integer(stringr::str_detect(description, "CC")),
                  ind_jumpball = stringr::str_c(ind_tipto_, ind_CC),
                  ind_other = as.integer(stringr::str_detect(description, "Other")),
                  ind_2ndtech = as.integer(stringr::str_detect(description, "Second Technical")),
                  ind_type1 = as.integer(stringr::str_detect(description, "Type 1")),
                  ind_type2 = as.integer(stringr::str_detect(description, "Type 2")),
                  ind_ejection = stringr::str_c(ind_other, ind_2ndtech, ind_no, ind_type1, ind_type2),
                  ind_1st = as.integer(stringr::str_detect(description, "1st")),
                  ind_2nd = as.integer(stringr::str_detect(description, "2nd")),
                  ind_3rd = as.integer(stringr::str_detect(description, "3rd")),
                  ind_4th = as.integer(stringr::str_detect(description, "4th")),
                  ind_OT = as.integer(stringr::str_detect(description, "OT")),
                  ind_period = stringr::str_c(ind_1st, ind_2nd, ind_3rd, ind_4th, ind_OT)) %>%
    dplyr::mutate(gram = NA_character_,
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Alley Oop Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Alley Oop Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Reverse Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Reverse Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Putback Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Reverse Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Alley Oop Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Reverse Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Reverse Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Slam Dunk (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Tip Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Dunk Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Alley Oop Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Alley Oop Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Reverse Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Reverse Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Alley Oop Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Alley Oop Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Reverse Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Reverse Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Slam Dunk (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 0 & ind_no == 0, '[player] Tip Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(1a)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Dunk Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 0 & ind_no == 0, '[player] Hook Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Hook Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Jump Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Jump Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Running Bank Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Running Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Running Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Running Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Bank Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Hook Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 0 & ind_no == 0, '[player] Hook Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Hook Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Jump Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Jump Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Running Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Running Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Running Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(2a)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 0 & ind_no == 0, '[player] Alley Oop Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Alley Oop Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Finger Roll Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Finger Roll Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Alley Oop Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Finger Roll Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Reverse Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Tip Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Tip Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Running Tip Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Tip Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Tip Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Layup Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Tip Shot' & ind_dist == 0 & ind_no == 0, '[player] Tip Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 0 & ind_no == 0, '[player] Alley Oop Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Alley Oop Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Finger Roll Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Finger Roll Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Cutting Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Cutting Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Putback Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Putback Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Alley Oop Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Alley Oop Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Finger Roll Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Reverse Layup (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Running Tip Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Tip Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Layup Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Tip Shot' & ind_dist == 0 & ind_no == 0, '[player] Tip Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(3a)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Tip Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == '' & ind_dist == 0 & ind_no == 1, '[player] No Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, '[player] [dist] No Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == '' & ind_dist == 0 & ind_no == 0, '[player] Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, '[player] [dist] Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Floating Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Floating Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Jump shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 0 & ind_no == 0, '[player] Fadeaway Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Fadeaway Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Fadeaway Jumper (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Fadeaway Jumper (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, '[player] Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, '[player] Jump Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Pullup Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, '[player] Pullup Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Pullup Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Running Bank shot' & ind_dist == 0 & ind_no == 0, '[player] Running Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Pull-Up Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Step Back Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, '[player] Step Back Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Step Back Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Fadeaway Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Fadeaway (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Fadeaway (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == '' & ind_dist == 0 & ind_no == 1, '[player] No Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, '[player] [dist] No Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == '' & ind_dist == 0 & ind_no == 0, '[player] Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, '[player] [dist] Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Bank shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Floating Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Floating Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Driving Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Driving Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Fadeaway Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Fadeaway Jumper (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, '[player] Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Pullup Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Pullup Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Running Pull-Up Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Running Pull-Up Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Step Back Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Step Back Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Fadeaway Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Fadeaway (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] Turnaround Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(4a)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] Turnaround Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, '[player] [dist] 3PT No Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Floating Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Fadeaway Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Fadeaway Jumper (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Fadeaway Jumper (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Floating Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Jump Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Jump Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Pullup Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Pullup Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Pullup Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Putback Layup (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Running Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Running Pull-Up Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Pull-Up Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Step Back Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Step Back Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Step Back Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Bank Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Fadeaway Bank Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Turnaround Fadeaway (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Fadeaway (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Turnaround Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Jump Shot (cnt PTS)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Floating Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Driving Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Driving Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Fadeaway Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Fadeaway Jumper (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Fadeaway Jumper (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Floating Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Jump Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Jump Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Pullup Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Pullup Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Pullup Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Running Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Running Pull-Up Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Running Pull-Up Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Step Back Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Step Back Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Step Back Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Step Back Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Bank Hook Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Bank Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Fadeaway Bank Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Turnaround Fadeaway (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Fadeaway (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, '[player] 3PT Turnaround Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  gram = ifelse(cod == '_1(5a)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, '[player] [dist] 3PT Turnaround Jump Shot (cnt PTS) ([player] cnt AST)', gram),
                  
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Alley Oop Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Alley Oop Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Reverse Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Reverse Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Putback Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Putback Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Reverse Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Reverse Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Alley Oop Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Alley Oop Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Reverse Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Slam Dunk', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Dunk Shot', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Alley Oop Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Alley Oop Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Cutting Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Driving Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Driving Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Reverse Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Driving Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Putback Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Putback Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Putback Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Reverse Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Putback Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Reverse Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Reverse Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Alley Oop Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Alley Oop Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Reverse Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Reverse Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Running Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Slam Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Slam Dunk [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(1b)' & tp_subaction == 'Tip Dunk Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Dunk Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Hook Bank Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Hook Bank Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Jump Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Jump Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Running Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Running Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Running Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Hook Shot', gram),
                  gram = ifelse(cod == '_2(2)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Hook Shot', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Bank Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Hook Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Jump Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Bank Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Jump Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Running Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Running Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Turnaround Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Bank Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(2b)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Alley Oop Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Alley Oop Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Finger Roll Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Finger Roll Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Putback Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Alley Oop Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Alley Oop Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Finger Roll Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Reverse Layup', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Tip Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Tip Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Running Tip Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Tip Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Layup Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Tip Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Shot', gram),
                  gram = ifelse(cod == '_2(3)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Shot', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Alley Oop Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Alley Oop Layup shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Alley Oop Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Finger Roll Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Cutting Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Finger Roll Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Cutting Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Cutting Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Cutting Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Driving Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Putback Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Putback Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Putback Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Alley Oop Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Alley Oop Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Finger Roll Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Finger Roll Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Running Reverse Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Reverse Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Tip Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Layup Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Tip Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Tip Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(3b)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Tip Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == '' & ind_dist == 0 & ind_no == 1, 'MISS [player] No Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, 'MISS [player] [dist] No Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == '' & ind_dist == 0 & ind_no == 0, 'MISS [player] Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Floating Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Floating Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Fadeaway Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Fadeaway Jumper', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Fadeaway Jumper', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Jump Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Pullup Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Pullup Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Pullup Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Pull-Up Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Step Back Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Step Back Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Step Back Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Bank Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Fadeaway Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Fadeaway Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Fadeaway Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Jump Shot', gram),
                  gram = ifelse(cod == '_2(4)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Jump Shot', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == '' & ind_dist == 0 & ind_no == 1, 'MISS [player] No Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, 'MISS [player] [dist] No Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == '' & ind_dist == 0 & ind_no == 0, 'MISS [player] Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Floating Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Floating Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Driving Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Driving Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Fadeaway Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Fadeaway Jumper [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Pullup Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Pullup Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Running Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Running Pull-Up Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Step Back Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Step Back Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Fadeaway Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Fadeaway Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Fadeaway Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] Turnaround Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(4b)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] Turnaround Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == '' & ind_dist == 1 & ind_no == 1, 'MISS [player] [dist] 3PT No Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == '' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Bank Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Bank Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Driving Floating Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Floating Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Dunk Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Dunk', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Fadeaway Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Fadeaway Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Fadeaway Jumper', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Fadeaway Jumper', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Floating Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Floating Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Hook Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Hook Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Jump Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Jump Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Jump Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Jump Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Layup', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Pullup Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Pullup Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Pullup Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Pullup Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Pullup Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Reverse Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Reverse Layup', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Running Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Layup Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Layup', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Running Pull-Up Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Pull-Up Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Step Back Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Step Back Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Step Back Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Step Back Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Tip Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Bank shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Bank Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Fadeaway Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Fadeaway Bank Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Fadeaway Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Fadeaway Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Hook Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Jump Shot', gram),
                  gram = ifelse(cod == '_2(5)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Jump Shot', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Floating Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Floating Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Driving Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Floating Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Driving Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Driving Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Driving Layup Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Driving Layup [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Fadeaway Jumper [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Fadeaway Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Fadeaway Jumper [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Floating Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Floating Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Hook Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Hook Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Hook Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Jump Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Jump Bank Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Jump Bank Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Pullup Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Pullup Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Pullup Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Running Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Running Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Running Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Running Pull-Up Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Running Pull-Up Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Running Pull-Up Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Step Back Bank Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Step Back Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Step Back Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Step Back Jump shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Step Back Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Tip Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Tip Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Turnaround Fadeaway Bank Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Fadeaway Bank Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Fadeaway Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Turnaround Fadeaway shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Fadeaway Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 0 & ind_no == 0, 'MISS [player] 3PT Turnaround Jump Shot [player] BLOCK (cnt BLK)', gram),
                  gram = ifelse(cod == '_2(5b)' & tp_subaction == 'Turnaround Jump Shot' & ind_dist == 1 & ind_no == 0, 'MISS [player] [dist] 3PT Turnaround Jump Shot [player] BLOCK (cnt BLK)', gram),
                  
                  gram = ifelse(cod == '_3(00c)', '[player] (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(00w)', 'MISS [player]', gram),
                  gram = ifelse(cod == '_3(11c)', '[player] Free Throw 1 of 1 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(11w)', 'MISS [player] Free Throw 1 of 1', gram),
                  gram = ifelse(cod == '_3(12c)', '[player] Free Throw 1 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(12w)', 'MISS [player] Free Throw 1 of 2', gram),
                  gram = ifelse(cod == '_3(13c)', '[player] Free Throw 1 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(13w)', 'MISS [player] Free Throw 1 of 3', gram),
                  gram = ifelse(cod == '_3(22c)', '[player] Free Throw 2 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(22w)', 'MISS [player] Free Throw 2 of 2', gram),
                  gram = ifelse(cod == '_3(23c)', '[player] Free Throw 2 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(23w)', 'MISS [player] Free Throw 2 of 3', gram),
                  gram = ifelse(cod == '_3(33c)', '[player] Free Throw 3 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(33w)', 'MISS [player] Free Throw 3 of 3', gram),
                  gram = ifelse(cod == '_3(40c)', '[player] Free Throw Technical (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(40w)', 'MISS [player] Free Throw Technical', gram),
                  gram = ifelse(cod == '_3(51c)', '[player] Free Throw Flagrant 1 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(51w)', 'MISS [player] Free Throw Flagrant 1 of 2', gram),
                  gram = ifelse(cod == '_3(52c)', '[player] Free Throw Flagrant 2 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(52w)', 'MISS [player] Free Throw Flagrant 2 of 2', gram),
                  gram = ifelse(cod == '_3(61c)', '[player] Free Throw Flagrant 1 of 1 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(71c)', '[player] Free Throw Clear Path 1 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(71w)', 'MISS [player] Free Throw Clear Path 1 of 2', gram),
                  gram = ifelse(cod == '_3(72c)', '[player] Free Throw Clear Path 2 of 2 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(72w)', 'MISS [player] Free Throw Clear Path 2 of 2', gram),
                  gram = ifelse(cod == '_3(81c)', '[player] Free Throw Flagrant 1 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(81w)', 'MISS [player] Free Throw Flagrant 1 of 3', gram),
                  gram = ifelse(cod == '_3(82c)', '[player] Free Throw Flagrant 2 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(82w)', 'MISS [player] Free Throw Flagrant 2 of 3', gram),
                  gram = ifelse(cod == '_3(83c)', '[player] Free Throw Flagrant 3 of 3 (cnt PTS)', gram),
                  gram = ifelse(cod == '_3(83w)', 'MISS [player] Free Throw Flagrant 3 of 3', gram),
                  
                  gram = ifelse(cod == '_4(0p)' & ind_unk == 0, '[player] REBOUND (Off:cnt Def:cnt)', gram),
                  gram = ifelse(cod == '_4(0t)' & ind_unk == 0, '[team] Rebound', gram),
                  gram = ifelse(cod == '_4(0u)' & ind_unk == 1, 'Unknown', gram),
                  gram = ifelse(cod == '_4(0u)' & ind_unk == 0, 'Normal Rebound', gram),
                  gram = ifelse(cod == '_4(1t)' & ind_unk == 0, '[team] Rebound', gram),
                  
                  gram = ifelse(cod == '_5(00p)' & ind_turn == '100000000000', '[player] No Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(00p)' & ind_turn == '000000000000', '[player] Turnover Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(01p)' & ind_turn == '100000001000', '[player] No Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(01p)' & ind_turn == '000000001000', '[player] Turnover Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(11p)' & ind_turn == '000000001000', '[player] Bad Pass Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(12p)' & ind_turn == '000000000000', '[player] Traveling Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(13p)' & ind_turn == '000000000000', '[player] Foul Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(13p)' & ind_turn == '010000000000', '[player] Offensive Foul Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(14p)' & ind_turn == '000000000000', '[player] Double Dribble Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(15p)' & ind_turn == '000000000000', '[player] Discontinue Dribble Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(16p)' & ind_turn == '001000000100', '[player] 3 Second Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(16p)' & ind_turn == '000000000100', '[team] Turnover: 3 Second Violation (T#cnt)', gram),
                  gram = ifelse(cod == '_5(17p)' & ind_turn == '000000000000', '[player] Inbound Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(18p)' & ind_turn == '000100000000', '[player] Backcourt Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(18p)' & ind_turn == '000000000000', '[team] Turnover: Backcourt (T#cnt)', gram),
                  gram = ifelse(cod == '_5(19p)' & ind_turn == '010000000000', '[player] Offensive Goaltending Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(20p)' & ind_turn == '001000000000', '[player] Lane Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(21p)' & ind_turn == '001000000000', '[player] Jump Ball Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(22p)' & ind_turn == '001000000000', '[player] Kicked Ball Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(23p)' & ind_turn == '000000000000', '[player] Illegal Assist Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(24p)' & ind_turn == '000000000000', '[player] Palming Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(25t)' & ind_turn == '000000000000', '[team] Turnover: Inbound (T#cnt)', gram),
                  gram = ifelse(cod == '_5(26p)' & ind_turn == '000000000000', '[player] Double Personal Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(27p)' & ind_turn == '000000000000', '[player] Punched Ball Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(28p)' & ind_turn == '000000000000', '[player] Swinging Elbows Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(29p)' & ind_turn == '000000000000', '[player] Basket from Below Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(30p)' & ind_turn == '000000000000', '[player] Illegal Screen Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(31p)' & ind_turn == '000010100000', '[player] Step Out of Bounds Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(31p)' & ind_turn == '001001100000', '[player] Player Out of Bounds Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(31p)' & ind_turn == '000000100000', '[player] Out Of Bounds Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(32p)' & ind_turn == '000000100000', '[player] Out of Bounds Lost Ball Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(33p)' & ind_turn == '000000010000', '[player] Poss Lost Ball Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(33p)' & ind_turn == '000000000000', '[player] Lost Ball Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(34p)' & ind_turn == '000000100001', '[player] Out of Bounds - Bad Pass Turnover Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(34p)' & ind_turn == '000000000000', '[player] Bad Pass Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(35p)' & ind_turn == '000000001000', '[player] Lost Ball Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(35p)' & ind_turn == '000000011000', '[player] Poss Lost Ball Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(35p)' & ind_turn == '000000101000', '[player] Out of Bounds Lost Ball Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)', gram),
                  gram = ifelse(cod == '_5(36t)' & ind_turn == '000000000100', '[team] Turnover: 8 Second Violation (T#cnt)', gram),
                  gram = ifelse(cod == '_5(37t)' & ind_turn == '000000000000', '[team] Turnover: Shot Clock (T#cnt)', gram),
                  gram = ifelse(cod == '_5(38t)' & ind_turn == '000000000000', '[team] Turnover: 5 Second Inbound (T#cnt)', gram),
                  gram = ifelse(cod == '_5(38t)' & ind_turn == '000000000100', '[team] Turnover: 5 Second Violation (T#cnt)', gram),
                  gram = ifelse(cod == '_5(39t)' & ind_turn == '000000000010', 'Excess Timeout Turnover', gram),
                  gram = ifelse(cod == '_5(39t)' & ind_turn == '000000000000', '[team] Turnover: (T#cnt)', gram),
                  gram = ifelse(cod == '_5(40t)' & ind_turn == '000000000000', '[team] Turnover: Too Many Players (T#cnt)', gram),
                  gram = ifelse(cod == '_5(41p)' & ind_turn == '001000000100', '[player] 5 Second Violation Turnover (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_5(43p)' & ind_turn == '000000000000', '[player] Opposite Basket Turnover (Pcnt.Tcnt)', gram),
                  
                  gram = ifelse(cod == '_6(01c)' & ind_fouls == '11001000000000', '[coach] Foul:T.FOUL ([referee])', gram),
                  gram = ifelse(cod == '_6(01c)' & ind_fouls == '11000000000000', '[coach] Foul:T.FOUL', gram),
                  gram = ifelse(cod == '_6(01c)' & ind_fouls == '00100000000000', '[coach] Foul:Non-Unsportsmanlike', gram),
                  gram = ifelse(cod == '_6(01c)' & ind_fouls == '00101000000000', '[coach] Foul:Non-Unsportsmanlike ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '01002000000100', '[player] T.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '01001000000100', '[player] T.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '01012000000000', '[player] T.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '01011000000000', '[player] T.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00002100000100', '[player] HANGING.TECH.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00001100000100', '[player] HANGING.TECH.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00011100000100', '[player] HANGING.TECH.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00012100000100', '[player] HANGING.TECH.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00001010000100', '[player] Taunting (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00002010000100', '[player] Taunting (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00011010000000', '[player] Taunting (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00012010000000', '[player] Taunting (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00102000000100', '[player] Non-Unsportsmanlike (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00101000000100', '[player] Non-Unsportsmanlike (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00112000000000', '[player] Non-Unsportsmanlike (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00111000000000', '[player] Non-Unsportsmanlike (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00102000000101', '[player] Non-Unsportsmanlike Tech Foul - Flopping (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(01p)' & ind_fouls == '00112000000001', '[player] Non-Unsportsmanlike Tech Foul - Flopping (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(01t)' & ind_fouls == '01000000000000', '[team] T.FOUL', gram),
                  gram = ifelse(cod == '_6(01t)' & ind_fouls == '00000000000000', '[team] Foul', gram),
                  gram = ifelse(cod == '_6(01u)' & ind_fouls == '00000000000000', 'Technical', gram),
                  gram = ifelse(cod == '_6(05p)' & ind_fouls == '00001000000000', '[team] T.Foul (Def. 3 Sec [player] )', gram),
                  gram = ifelse(cod == '_6(05p)' & ind_fouls == '00002000000000', '[team] T.Foul (Def. 3 Sec [player] ) ([referee])', gram),
                  gram = ifelse(cod == '_6(06t)' & ind_fouls == '00000001000000', '[team] Delay', gram),
                  gram = ifelse(cod == '_6(06t)' & ind_fouls == '00000000000000', '[team] Foul', gram),
                  gram = ifelse(cod == '_6(06u)' & ind_fouls == '00000001000000', 'Delay Technical', gram),
                  gram = ifelse(cod == '_6(08t)' & ind_fouls == '00000000000000', '[team] Excess Timeout Technical', gram),
                  gram = ifelse(cod == '_6(08u)' & ind_fouls == '00000000000000', 'Excess Timeout Technical', gram),
                  gram = ifelse(cod == '_6(09t)' & ind_fouls == '00000000000000', '[team] Too Many Players Tech Foul', gram),
                  gram = ifelse(cod == '_6(10a)' & ind_fouls == '00002000000100', '[player] P.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(10a)' & ind_fouls == '00001000000100', '[player] P.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(10a)' & ind_fouls == '00001000100100', '[player] Personal Block Foul (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(10a)' & ind_fouls == '00002000100100', '[player] Personal Block Foul (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(10a)' & ind_fouls == '00000000000000', 'Personal', gram),
                  gram = ifelse(cod == '_6(10p)' & ind_fouls == '00012000000000', '[player] P.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(10p)' & ind_fouls == '00011000000000', '[player] P.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(10p)' & ind_fouls == '00011000100000', '[player] Personal Block Foul (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(10p)' & ind_fouls == '00012000100000', '[player] Personal Block Foul (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00002000000100', '[player] S.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00001000000100', '[player] S.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00001000100100', '[player] Shooting Block Foul (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00002000100100', '[player] Shooting Block Foul (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00002000010100', '[player] S.FOUL (Pcnt.Tcnt) (.)', gram),
                  gram = ifelse(cod == '_6(11a)' & ind_fouls == '00000000000000', 'Shooting', gram),
                  gram = ifelse(cod == '_6(11p)' & ind_fouls == '00012000000000', '[player] S.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(11p)' & ind_fouls == '00011000000000', '[player] S.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(11p)' & ind_fouls == '00011000100000', '[player] Shooting Block Foul (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(11p)' & ind_fouls == '00012000100000', '[player] Shooting Block Foul (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(11p)' & ind_fouls == '00012000010000', '[player] S.FOUL (Pcnt.PN) (.)', gram),
                  gram = ifelse(cod == '_6(12a)' & ind_fouls == '00002000000100', '[player] L.B.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(12a)' & ind_fouls == '00001000000100', '[player] L.B.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(12p)' & ind_fouls == '00012000000000', '[player] L.B.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(12p)' & ind_fouls == '00011000000000', '[player] L.B.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00002000000000', '[player] OFF.Foul (Pcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00001000000000', '[player] OFF.Foul (Pcnt)', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00002000001100', '[player] Offensive Charge Foul (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00002000001000', '[player] Offensive Charge Foul (Pcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00001000001100', '[player] Offensive Charge Foul (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00012000001000', '[player] Offensive Charge Foul (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00001000001000', '[player] Offensive Charge Foul (Pcnt)', gram),
                  gram = ifelse(cod == '_6(13a)' & ind_fouls == '00011000001000', '[player] Offensive Charge Foul (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(14a)' & ind_fouls == '00001000000100', '[player] IN.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(14a)' & ind_fouls == '00002000000100', '[player] IN.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(14p)' & ind_fouls == '00011000000000', '[player] IN.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(14p)' & ind_fouls == '00012000000000', '[player] IN.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(15a)' & ind_fouls == '00002000000100', '[player] AWAY.FROM.PLAY.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(15a)' & ind_fouls == '00001000000100', '[player] AWAY.FROM.PLAY.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(15p)' & ind_fouls == '00012000000000', '[player] AWAY.FROM.PLAY.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(15p)' & ind_fouls == '00011000000000', '[player] AWAY.FROM.PLAY.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(16a)' & ind_fouls == '00001000000100', '[player] PUNCH.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(16a)' & ind_fouls == '00002000000100', '[player] PUNCH.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(17a)' & ind_fouls == '00001000000100', '[player] C.P.FOUL (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(17a)' & ind_fouls == '00002000000100', '[player] C.P.FOUL (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(17p)' & ind_fouls == '00011000000000', '[player] C.P.FOUL (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(17p)' & ind_fouls == '00012000000000', '[player] C.P.FOUL (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(18a)' & ind_fouls == '00002000000001', 'Foul : Double Personal - [player] (cnt PF), [player] (cnt PF)', gram),
                  gram = ifelse(cod == '_6(18a)' & ind_fouls == '00003000000001', 'Foul : Double Personal - [player] (cnt PF), [player] (cnt PF) ([referee])', gram),
                  gram = ifelse(cod == '_6(18a)' & ind_fouls == '00000000000000', 'Double Personal', gram),
                  gram = ifelse(cod == '_6(19a)' & ind_fouls == '01002000000100', '[player] FLAGRANT.FOUL.TYPE1 (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(19a)' & ind_fouls == '01001000000100', '[player] FLAGRANT.FOUL.TYPE1 (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(19p)' & ind_fouls == '01012000000100', '[player] FLAGRANT.FOUL.TYPE1 (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(19p)' & ind_fouls == '01011000000100', '[player] FLAGRANT.FOUL.TYPE1 (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(20a)' & ind_fouls == '01002000000100', '[player] FLAGRANT.FOUL.TYPE2 (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(20a)' & ind_fouls == '01001000000100', '[player] FLAGRANT.FOUL.TYPE2 (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(20p)' & ind_fouls == '01011000000100', '[player] FLAGRANT.FOUL.TYPE2 (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(20p)' & ind_fouls == '01012000000100', '[player] FLAGRANT.FOUL.TYPE2 (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(21a)' & ind_fouls == '00002000000100', '[player] Personal Take Foul (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(21a)' & ind_fouls == '00001000000100', '[player] Personal Take Foul (Pcnt.Tcnt)', gram),
                  gram = ifelse(cod == '_6(21p)' & ind_fouls == '00012000000000', '[player] Personal Take Foul (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(21p)' & ind_fouls == '00011000000000', '[player] Personal Take Foul (Pcnt.PN)', gram),
                  gram = ifelse(cod == '_6(22a)' & ind_fouls == '00002000000100', '[player] Transition Take Foul (Pcnt.Tcnt) ([referee])', gram),
                  gram = ifelse(cod == '_6(22p)' & ind_fouls == '00012000000000', '[player] Transition Take Foul (Pcnt.PN) ([referee])', gram),
                  gram = ifelse(cod == '_6(4cc)' & ind_fouls == '00001000000110', '[coach] Foul:DOUBLE.TECHNICAL.FOUL ([referee])', gram),
                  gram = ifelse(cod == '_6(4pc)' & ind_fouls == '00001000000001', 'Double Technical - [player], [coach] ([referee])', gram),
                  gram = ifelse(cod == '_6(4pc)' & ind_fouls == '00000000000110', '[coach] Foul:DOUBLE.TECHNICAL.FOUL', gram),
                  gram = ifelse(cod == '_6(4pc)' & ind_fouls == '00001000000110', '[coach] Foul:DOUBLE.TECHNICAL.FOUL ([referee])', gram),
                  gram = ifelse(cod == '_6(4pp)' & ind_fouls == '00001000000001', 'Double Technical - [player], [player] ([referee])', gram),
                  gram = ifelse(cod == '_6(4pp)' & ind_fouls == '00000000000001', 'Double Technical - [player], [player]', gram),
                  gram = ifelse(cod == '_6(4pp)' & ind_fouls == '00000000000000', 'Double Technical', gram),
                  
                  gram = ifelse(cod == '_7(0p)' & ind_violation == '1100', '[player] Violation:No Violation', gram),
                  gram = ifelse(cod == '_7(1t)' & ind_violation == '0100', '[team] Violation: Delay of game Violation', gram),
                  gram = ifelse(cod == '_7(1t)' & ind_violation == '0000', 'Delay Of Game', gram),
                  gram = ifelse(cod == '_7(2p)' & ind_violation == '0110', '[player] Violation:Defensive Goaltending ([referee])', gram),
                  gram = ifelse(cod == '_7(2p)' & ind_violation == '0100', '[player] Violation:Defensive Goaltending', gram),
                  gram = ifelse(cod == '_7(3p)' & ind_violation == '0100', '[player] Violation:Lane', gram),
                  gram = ifelse(cod == '_7(3p)' & ind_violation == '0000', 'Lane', gram),
                  gram = ifelse(cod == '_7(3p)' & ind_violation == '0110', '[player] Violation:Lane ([referee])', gram),
                  gram = ifelse(cod == '_7(4p)' & ind_violation == '0100', '[player] Violation:Jump Ball', gram),
                  gram = ifelse(cod == '_7(4p)' & ind_violation == '0110', '[player] Violation:Jump Ball ([referee])', gram),
                  gram = ifelse(cod == '_7(5p)' & ind_violation == '0110', '[player] Violation:Kicked Ball ([referee])', gram),
                  gram = ifelse(cod == '_7(5p)' & ind_violation == '0100', '[player] Violation:Kicked Ball', gram),
                  gram = ifelse(cod == '_7(5p)' & ind_violation == '0111', '[player] Violation:Kicked Ball (.)', gram),
                  gram = ifelse(cod == '_7(6p)' & ind_violation == '0000', 'Double Lane', gram),
                  gram = ifelse(cod == '_7(6p)' & ind_violation == '0100', '[player] Violation:Double Lane', gram),
                  gram = ifelse(cod == '_7(6p)' & ind_violation == '0110', '[player] Violation:Double Lane ([referee])', gram),
                  gram = ifelse(cod == '_7(6p)' & ind_violation == '0111', '[player] Violation:Double Lane (.)', gram),
                  
                  gram = ifelse(cod == '_8(0)', 'SUB: [player] FOR [player]', gram),
                  
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '1011010', '[team] Timeout: Regular (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '0111010', '[team] Timeout: Regular (Reg.cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '0101010', '[team] Timeout: Short (Reg.cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '1001010', '[team] Timeout: Short (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '0010010', 'Timeout: Regular', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '0010000', 'Regular', gram),
                  gram = ifelse(cod == '_9(0)' & ind_timeout == '0001110', 'Timeout: Short', gram),
                  gram = ifelse(cod == '_9(1)' & ind_timeout == '1001010', '[team] Timeout: Coach Challenge (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(1)' & ind_timeout == '0101010', '[team] Timeout: Coach Challenge (Reg.cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(2)' & ind_timeout == '0000010', 'Timeout: Official', gram),
                  gram = ifelse(cod == '_9(2)' & ind_timeout == '0101010', '[team] Timeout: Official (Reg.cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(2)' & ind_timeout == '1001010', '[team] Timeout: Official (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(3)' & ind_timeout == '0000011', 'Timeout: No Timeout', gram),
                  gram = ifelse(cod == '_9(3)' & ind_timeout == '1001011', '[team] Timeout: No Timeout (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(3)' & ind_timeout == '0101011', '[team] Timeout: No Timeout (Reg.cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(3)' & ind_timeout == '1001010', '[team] Timeout: Timeout (Full cnt Short cnt)', gram),
                  gram = ifelse(cod == '_9(3)' & ind_timeout == '0101010', '[team] Timeout: Timeout (Reg.cnt Short cnt)', gram),
                  
                  gram = ifelse(cod == '_10(0)' & ind_jumpball == '10', 'Jump Ball [player] vs. [player]: Tip to [player]', gram),
                  gram = ifelse(cod == '_10(0)' & ind_jumpball == '00', 'Jump Ball [player] vs. [player]: Tip to', gram),
                  gram = ifelse(cod == '_10(1)' & ind_jumpball == '10', 'Jump Ball [player] vs. [player]: Tip to [player]', gram),
                  gram = ifelse(cod == '_10(1)' & ind_jumpball == '00', 'Jump Ball [player] vs. [player]: Tip to', gram),
                  gram = ifelse(cod == '_10(2)' & ind_jumpball == '11', 'Jump Ball (CC) [player] vs. [player]: Tip to [player]', gram),
                  gram = ifelse(cod == '_10(2)' & ind_jumpball == '00', 'Coach Challenge', gram),
                  
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '10000', '[player] Ejection:Other', gram),
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '01000', '[player] Ejection:Second Technical', gram),
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '00001', '[player] Ejection:First Flagrant Type 2', gram),
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '00100', '[player] Ejection:No Ejection', gram),
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '00010', '[player] Ejection:Second Flagrant Type 1', gram),
                  gram = ifelse(cod == '_11(0)' & ind_ejection == '00000', '[player] Ejection:', gram),
                  gram = ifelse(cod == '_11(1)' & ind_ejection == '01000', '[coach] Ejection:Second Technical', gram),
                  gram = ifelse(cod == '_11(1)' & ind_ejection == '10000', '[coach] Ejection:Other', gram),
                  gram = ifelse(cod == '_11(1)' & ind_ejection == '00100', '[coach] Ejection:No Ejection', gram),
                  
                  gram = ifelse(cod == '_12(0)' & ind_period == '10001', 'Start of 1st OT ([hour])', gram),
                  gram = ifelse(cod == '_12(0)' & ind_period == '01001', 'Start of 2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_12(0)' & ind_period == '00101', 'Start of 3rd OT ([hour])', gram),
                  gram = ifelse(cod == '_12(0)' & ind_period == '00011', 'Start of 4th OT ([hour])', gram),
                  gram = ifelse(cod == '_12(1)' & ind_period == '10000', 'Start of 1st Period ([hour])', gram),
                  gram = ifelse(cod == '_12(2)' & ind_period == '01000', 'Start of 2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_12(3)' & ind_period == '00100', 'Start of 3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_12(4)' & ind_period == '00010', 'Start of 4th Period ([hour])', gram),
                  
                  gram = ifelse(cod == '_13(0)' & ind_period == '10001', 'End of 1st OT ([hour])', gram),
                  gram = ifelse(cod == '_13(0)' & ind_period == '01001', 'End of 2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_13(0)' & ind_period == '00101', 'End of 3rd OT ([hour])', gram),
                  gram = ifelse(cod == '_13(0)' & ind_period == '00011', 'End of 4th OT ([hour])', gram),
                  gram = ifelse(cod == '_13(1)' & ind_period == '10000', 'End of 1st Period ([hour])', gram),
                  gram = ifelse(cod == '_13(2)' & ind_period == '01000', 'End of 2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_13(3)' & ind_period == '00100', 'End of 3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_13(4)' & ind_period == '00010', 'End of 4th Period ([hour])', gram),
                  
                  gram = ifelse(cod == '_18(0)' & ind_period == '00000', 'Support Ruling', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(0)' & ind_period == '00101', 'Instant Replay3rd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '00000', 'Overturn Ruling', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(1)' & ind_period == '00101', 'Instant Replay3rd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '00000', 'Altercation Ruling', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(2)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(3)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(4)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(4)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(4)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(4)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(4)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '00000', 'Coach Challenge Overturn Ruling', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(5)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '01001', 'Instant Replay2nd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(6)' & ind_period == '00101', 'Instant Replay3rd OT ([hour])', gram),
                  gram = ifelse(cod == '_18(7)' & ind_period == '10000', 'Instant Replay1st Period ([hour])', gram),
                  gram = ifelse(cod == '_18(7)' & ind_period == '01000', 'Instant Replay2nd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(7)' & ind_period == '00100', 'Instant Replay3rd Period ([hour])', gram),
                  gram = ifelse(cod == '_18(7)' & ind_period == '00010', 'Instant Replay4th Period ([hour])', gram),
                  gram = ifelse(cod == '_18(7)' & ind_period == '10001', 'Instant Replay1st OT ([hour])', gram)) %>%
    dplyr::mutate(gram = ifelse(cod == "_5(01p)" & is.na(gram), "[player] No Turnover (Pcnt.Tcnt) [player] STEAL (cnt STL)", gram),
                  gram = ifelse(cod == "_5(12p)" & is.na(gram), "[player] Traveling Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(13p)" & is.na(gram), "[player] Foul Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(20p)" & is.na(gram), "[player] Lane Violation Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(21p)" & is.na(gram), "[player] Jump Ball Violation Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(22p)" & is.na(gram), "[player] Kicked Ball Violation Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(31p)" & is.na(gram), "[player] Step Out of Bounds Turnover (Pcnt.Tcnt)", gram),
                  gram = ifelse(cod == "_5(36t)" & is.na(gram), "[team] Turnover: 8 Second Violation (T#cnt)", gram),
                  gram = ifelse(cod == "_6(01c)" & is.na(gram), "[coach] Foul:T.FOUL ([referee])", gram),
                  gram = ifelse(cod == "_6(01p)" & is.na(gram), "[player] T.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(05p)" & is.na(gram), "[team] T.Foul (Def. 3 Sec [player] ) ([referee])", gram),
                  gram = ifelse(cod == "_6(10p)" & is.na(gram), "[player] P.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(11p)" & is.na(gram), "[player] S.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(12p)" & is.na(gram), "[player] L.B.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(13a)" & is.na(gram), "[player] OFF.Foul (Pcnt) ([referee])", gram),
                  gram = ifelse(cod == "_6(14p)" & is.na(gram), "[player] IN.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(15p)" & is.na(gram), "[player] AWAY.FROM.PLAY.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(17p)" & is.na(gram), "[player] C.P.FOUL (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(18a)" & is.na(gram), "Foul : Double Personal - [player] (cnt PF), [player] (cnt PF) ([referee])", gram),
                  gram = ifelse(cod == "_6(21p)" & is.na(gram), "[player] Personal Take Foul (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(22p)" & is.na(gram), "[player] Transition Take Foul (Pcnt.PN) ([referee])", gram),
                  gram = ifelse(cod == "_6(4pp)" & is.na(gram), "Double Technical - [player], [player] ([referee])", gram),
                  gram = ifelse(cod == "_7(0p)" & is.na(gram), "[player] Violation:No Violation", gram),
                  gram = ifelse(cod == "_7(2p)" & is.na(gram), "[player] Violation:Defensive Goaltending ([referee])", gram),
                  gram = ifelse(cod == "_7(4p)" & is.na(gram), "[player] Violation:Jump Ball ([referee])", gram),
                  gram = ifelse(cod == "_7(5p)" & is.na(gram), "[player] Violation:Kicked Ball ([referee])", gram),
                  gram = ifelse(cod == "_9(0)" & is.na(gram), "Timeout: Short", gram),
                  gram = ifelse(cod == "_9(2)" & is.na(gram), "Timeout: Official", gram),
                  gram = ifelse(cod == "_9(3)" & is.na(gram), "Timeout: No Timeout", gram)) %>% 
    dplyr::select(-c(ind_dist, ind_no, ind_unk, ind_off, ind_viot, ind_ba, ind_step, ind_play,
                     ind_out, ind_pos, ind_ste, ind_sec, ind_exc, ind_trace, ind_turn, ind_tfoul,
                     ind_tfoul2, ind_uns, ind_pn, cnt_par, ind_hang, ind_tau, ind_delay, ind_block,
                     ind_dot, ind_charge, ind_tcnt, ind_double, ind_trace, ind_fouls, ind_vio, 
                     ind_violation, ind_full, ind_reg, ind_reg2, ind_short, ind_short2, ind_time,
                     ind_timeout, ind_CC, ind_tipto_, ind_jumpball, ind_other, ind_2ndtech, ind_type1,
                     ind_type2, ind_ejection, ind_1st, ind_2nd, ind_3rd, ind_4th, ind_OT, ind_period))
  
  
}

FOLDER_PROCESSED_DATA <- "D:/Mestrado/NBA/nba/data/processed/"
FILE_PBP_TOTAL <- paste0(FOLDER_PROCESSED_DATA, "pbp_season_files/concatenate_data/pbptotal.RData")
load(FILE_PBP_TOTAL)

future::plan(future::multisession(), workers = future::availableCores())

#df_freqandcod_pbp
df_freqandcod_pbp <- pbptotal %>% 
  dplyr::group_split(season) %>% 
  furrr::future_map(.x = ., .f = execute_pre_process_data, .progress = TRUE) %>% 
  dplyr::bind_rows() %>% 
  dplyr::mutate(tp_action = stringr::str_trim(tp_action),
                tp_action = ifelse(is.na(tp_action) & tp_event == 4, "Rebound", tp_action),
                tp_action = ifelse(is.na(tp_action) & tp_event == 3, "Free Throw", tp_action),
                tp_action = ifelse(is.na(tp_action) & tp_event == 5, "Turnover", tp_action),
                tp_action = ifelse(is.na(tp_action) & tp_event == 7, "Violation", tp_action)) %>%
  dplyr::mutate(tp_subaction = stringr::str_trim(tp_subaction),
                tp_subaction = ifelse(stringr::str_detect(cod, "_[1|2]\\(1"), "Dunk shot", tp_subaction),
                tp_subaction = ifelse(stringr::str_detect(cod, "_[1|2]\\(2"), "Hook shot", tp_subaction),
                tp_subaction = ifelse(stringr::str_detect(cod, "_[1|2]\\(3"), "Layup shot", tp_subaction),
                tp_subaction = ifelse(stringr::str_detect(cod, "_[1|2]\\(4"), "Jump shot", tp_subaction),
                tp_subaction = ifelse(stringr::str_detect(cod, "_[1|2]\\(5"), "3pt Jump shot", tp_subaction)) %>%
  dplyr::group_by(season) %>% 
  dplyr::mutate(num_games = dplyr::n_distinct(game_id)) %>% 
  dplyr::ungroup() %>% 
  dplyr::group_by(tp_event, tp_action, tp_subaction, p, season, num_games, cod, ind) %>%
  dplyr::summarise(n = dplyr::n(), .groups = 'drop') %>%
  dplyr::group_by(tp_event, tp_action, tp_subaction, p, cod, ind) %>%
  dplyr::mutate(cnt = sum(n)) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(n = 1000 * n / num_games) %>%
  dplyr::mutate(season = stringr::str_replace(season, "([0-9]{4})(\\-)([0-9]{2})", "s\\3")) %>%
  dplyr::select(-num_games) %>%
  tidyr::spread(season, n) %>%
  dplyr::arrange(tp_event, cod) %>% 
  dplyr::mutate_if(.predicate = is.double, .funs = round, digits = 2)

future::plan(future::sequential())

seasons <- c('s09', 's10', 's11', 's12', 's13', 's14', 's15', 's16', 's17', 's18', 's19', 's20', 's21', 's22', 's23', 's24')

df_freqandcod_pbp$cv <- df_freqandcod_pbp[, seasons] %>% 
  dplyr::mutate_all(.funs = function(x){ifelse(is.na(x), 0, x)}) %>% 
  apply(X = ., MARGIN = 1, FUN = function(x){sd(x)/mean(x)})

df_freqandcod_pbp <- df_freqandcod_pbp %>% 
  dplyr::mutate_at(.vars = seasons, .funs = round, digits = 2)

save(df_freqandcod_pbp, file = paste0(FOLDER_PROCESSED_DATA, "df_freqandcod_pbp.RData"))

#####################

future::plan(future::multisession(), workers = future::availableCores())

pbp <- pbptotal %>% 
  dplyr::group_split(season) %>% 
  furrr::future_map(.x = ., .f = build_df_pbp_plays, .progress = TRUE) %>% 
  furrr::future_map(.x = ., .f = put_grammar_in_pbp, .progress = TRUE) %>% 
  dplyr::bind_rows() %>% 
  dplyr::select(-c(p, ind, tp))

future::plan(future::sequential())

fouls_count <- c("_6(10a)", "_6(10p)", "_6(11a)", "_6(11p)", "_6(12a)", "_6(12p)", 
                 "_6(14a)", "_6(14p)", "_6(15a)", "_6(15p)", "_6(16a)", "_6(17a)",
                 "_6(17p)", "_6(19a)", "_6(19p)", "_6(20a)", "_6(20p)", "_6(21a)",
                 "_6(21p)", "_6(22a)", "_6(22p)")

pbp <- pbp %>% 
  dplyr::mutate(cntfouls1 = ifelse(cod %in% fouls_count, 1, 0),
                cntfouls2 = cntfouls1 * stringr::str_detect(clock, "(02\\:00\\:00|^01\\:|^00\\:)")) %>% 
  dplyr::group_by(game_id, period, location) %>% 
  dplyr::mutate(cntfouls1 = cumsum(cntfouls1),
                cntfouls2 = cumsum(cntfouls2)) %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cntfouls1 = ifelse(cod %in% fouls_count, cntfouls1, 0),
                cntfouls2 = ifelse(cod %in% fouls_count, cntfouls2, 0))


save(pbp, file = paste0(FOLDER_PROCESSED_DATA, "pbp.RData"))

####################

future::plan(future::multisession(), workers = future::availableCores())

freq_plays_by_period <- pbptotal %>% 
  dplyr::group_split(season) %>% 
  furrr::future_map(.x = ., .f = build_df_freq_plays, .progress = TRUE) %>% 
  dplyr::bind_rows() %>% 
  dplyr::as_tibble()

future::plan(future::sequential())

save(freq_plays_by_period, file = paste0(FOLDER_PROCESSED_DATA, "freq_plays_by_period.RData"))

####################

freq_plays_by_cod <- freq_plays_by_period %>% 
  dplyr::group_by(tp_event, tp_action, tp_subevent, tp_subaction, cod, season) %>% 
  dplyr::summarise(n = sum(n), .groups = 'drop_last') %>% 
  dplyr::mutate(cnt = sum(n)) %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(season = stringr::str_replace(season, "([0-9]{4}\\-)([0-9]{2})", '\\2')) %>% 
  dplyr::mutate(season = paste0('s', season)) %>% 
  tidyr::spread(season, n)

save(freq_plays_by_cod, file = paste0(FOLDER_PROCESSED_DATA, "freq_plays_by_cod.RData"))


